{"version":3,"file":"bundles\\pages\\index.js","sources":["webpack:///webpack/bootstrap 26556a1bc7a931e97a09","webpack:///components/Chat.js","webpack:///components/ChatMessage.js","webpack:///components/Layout.js","webpack:///pages/index.js","webpack:///external \"axios\"","webpack:///external \"next/head\"","webpack:///external \"pusher-js\"","webpack:///external \"react\""],"sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tvar threw = true;\n \t\ttry {\n \t\t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n \t\t\tthrew = false;\n \t\t} finally {\n \t\t\tif(threw) delete installedModules[moduleId];\n \t\t}\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 26556a1bc7a931e97a09","import React, { Component, Fragment } from 'react';\nimport axios from 'axios';\nimport Pusher from 'pusher-js';\nimport ChatMessage from './ChatMessage';\n\nconst colors = [\n  '#e21400', '#91580f', '#f8a700', '#f78b00',\n  '#58dc00', '#287b00', '#a8f07a', '#4ae8c4',\n  '#3b88eb', '#3824aa', '#a700ff', '#d300e7'\n];\n\nconst getUsernameColor = (username) => {\n  // Compute hash code\n  let hash = 7;\n  for (let i = 0; i < username.length; i++) {\n    hash = username.charCodeAt(i) + (hash << 5) - hash;\n  }\n  // Calculate color\n  const index = Math.abs(hash % colors.length);\n  return colors[index];\n};\n\nconst emojis = {\n  sad: [55357, 56864],\n  happy: [55357, 56832],\n  neutral: [55357, 56848]\n};\n\nconst RIGHT = 'right';\nconst LEFT = 'left';\n\nconst encrypted = true;\n\nclass Chat extends Component {\n  state = { chats: [] };\n\n  scrollToBottom = () => {\n    this.chatsEnd.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  componentDidMount() {\n    this.scrollToBottom();\n    const cluster = process.env.PUSHER_APP_CLUSTER;\n    const appKey = process.env.PUSHER_APP_KEY;\n    const pusherConfig = {cluster, encrypted};\n    this.pusher = new Pusher(appKey, pusherConfig);\n\n    this.channel = this.pusher.subscribe('chat-room');\n    this.channel.bind('new-message', ({ chat = null }) => {\n      const { chats } = this.state;\n      if (chat) {\n        chats.push(chat);\n      }\n      this.setState({ chats });\n    });\n\n    this.pusher.connection.bind('connected', () => {\n      axios.post('/messages')\n        .then(response => {\n          const chats = response.data.messages;\n          this.setState({ chats });\n        });\n    });\n  }\n\n  componentDidUpdate() {\n    this.scrollToBottom();\n  }\n\n  componentWillUnmount() {\n    this.pusher.disconnect();\n  }\n\n  handleKeyUp = ({ keyCode, shiftKey, target }) => {\n    if (keyCode === 13 && !shiftKey) {\n      const timestamp = +new Date;\n      const { value: message } = target;\n      const { activeUser: user } = this.props;\n      const chat = { user, message, timestamp };\n      target.value = '';\n      axios.post('/message', chat);\n    }\n  };\n\n  renderChat = (chat, idx) => {\n    const previousIndex = Math.max(0, idx - 1);\n    const previousChat = this.state.chats[previousIndex];\n    const position = (chat.user === this.props.activeUser) ? RIGHT : LEFT; // user messages on right\n\n    const isFirst = (previousIndex === idx);\n    const inSequence = (chat.user === previousChat.user);\n    const hasDelay = Math.ceil((chat.timestamp - previousChat.timestamp) / (1000 * 60));\n\n    let mood;\n    if (chat.sentiment === 0) {\n      mood = emojis.neutral;\n    } else {\n      mood = (chat.sentiment > 0) ? emojis.happy : emojis.sad;\n    }\n    const username = chat.user || 'Anonymous';\n    const usernameColor = getUsernameColor(username);\n    return (\n      <Fragment key={idx}>\n        {\n          (isFirst || !inSequence || hasDelay) ?\n            (\n              <div\n                className={`d-block w-100 font-weight-bold text-dark mt-4 pb-1 px-1 text-${position}`}\n                style={{ fontSize: '0.9rem' }}>\n                <span style={ { color: usernameColor } }>\n                  { username }\n                  { ' ' }\n                  <span style={ { fontSize: '1.2rem' } }>\n                    { String.fromCodePoint(...mood) }\n                  </span>\n                </span>\n              </div>\n            ) : null\n        }\n        <ChatMessage message={chat.message} position={position} />\n      </Fragment>\n    )\n  };\n\n  render() {\n    return (\n      (this.props.activeUser) ?\n        <Fragment>\n          <div className=\"border-bottom border-gray w-100 d-flex align-items-center bg-white\" style={{height: 90}}>\n            <h2 className=\"text-dark mb-0 mx-4 px-2\">{this.props.activeUser}</h2>\n          </div>\n          <div\n            className=\"px-4 pb-4 w-100 d-flex flex-row flex-wrap align-items-start align-content-start position-relative\"\n            style={{ height: 'calc(100% - 180px)', overflowY: 'scroll' }}>\n            { this.state.chats.map(this.renderChat) }\n            <div style={{ clear: 'both', float: 'left'}} ref={(el) => { this.chatsEnd = el }}></div>\n          </div>\n          <div className=\"border-bottom border-gray w-100 d-flex align-items-center bg-light\" style={{minHeight: 90}}>\n            <textarea\n              className=\"form-control px-3 py-2\"\n              onKeyUp={this.handleKeyUp}\n              placeholder=\"Enter a chat message\"\n              style={{ resize: 'none' }}/>\n          </div>\n        </Fragment> : null\n    );\n  }\n}\n\nexport default Chat;\n\n\n// WEBPACK FOOTER //\n// components/Chat.js","import React from 'react';\n\nconst ChatMessage = ({ position = 'left', message }) => {\n  const isRight = position.toLowerCase() === 'right';\n  const align = (isRight) ? 'text-right' : 'text-left';\n  const justify = (isRight) ? 'justify-content-end' : 'justify-content-start';\n\n  const messageBoxStyles = {\n    maxWidth: '70%',\n    flexGrow: 0\n  };\n\n  const messageStyles = {\n    fontWeight: 500,\n    lineHeight: 1.4,\n    whiteSpace: 'pre-wrap'\n  };\n\n  return (\n    <div className={`w-100 my-1 d-flex ${justify}`}>\n      <div className=\"bg-light rounded border border-gray p-2\" style={messageBoxStyles}>\n          <span className={`d-block text-secondary ${align}`} style={messageStyles}>\n            {message}\n          </span>\n      </div>\n    </div>\n  )\n};\n\nexport default ChatMessage;\n\n\n// WEBPACK FOOTER //\n// components/ChatMessage.js","import React, { Fragment } from 'react';\nimport Head from 'next/head';\n\nconst Layout = (props) => {\n  return (\n    <Fragment>\n      <Head>\n        <meta charSet=\"utf-8\"/>\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\"/>\n        <link\n          rel=\"stylesheet\"\n          href=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css\"\n          integrity=\"sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm\"\n          crossOrigin=\"anonymous\"/>\n        <title>{ props.pageTitle || 'Realtime Chat, Y\\'all!' }</title>\n      </Head>\n      { props.children }\n    </Fragment>\n  );\n};\nexport default Layout;\n\n\n// WEBPACK FOOTER //\n// components/Layout.js","import React, { Component } from 'react';\nimport Layout from '../components/Layout';\nimport Chat from '../components/Chat';\n\nclass IndexPage extends Component {\n  state = { user: null };\n\n  handleKeyUp = ({ keyCode, target }) => {\n    if (keyCode === 13) { // On pressing enter\n      const { value: user } = target;\n      this.setState({ user });\n    }\n  };\n\n  render() {\n    const { user } = this.state;\n\n    const nameInputStyles = {\n      background: 'transparent',\n      color: '#999',\n      border: 0,\n      borderBottom: '1px solid #666',\n      borderRadius: 0,\n      fontSize: '3rem',\n      fontWeight: 500,\n      boxShadow: 'none !import'\n    };\n\n    return (\n      <Layout pageTitle=\"Chat App\">\n        <main className=\"container-fluid position-absolute h-100 bg-dark\">\n          <div className=\"row position-absolute w-100 h-100\">\n            <div className=\"row position-absolute w-100 h-100\">\n              <section className=\"col-md-8 d-flex flex-row flex-wrap align-items-center align-content-center px-5\">\n                <div className=\"px-5 mx-5\">\n                  <span className=\"d-block w-100 h1 text-light\" style={{ marginTop: -50 }}>\n                    {\n                      (user) ?\n                        (<span><span style={{ color: '#999'}}>Hello!</span> {user}</span>) :\n                        'What is your name?'\n                    }\n                  </span>\n                  {\n                    (!user) ?\n                      (\n                        <input\n                          type=\"text\"\n                          className=\"form-control mt-3 px-3 py-2\"\n                          onKeyUp={this.handleKeyUp}\n                          autoComplete=\"off\"\n                          style={nameInputStyles} />\n                      ) : null\n                  }\n                </div>\n              </section>\n              <section\n                className=\"col-md-4 position-relative d-flex flex-wrap h-100 align-items-start align-content-between bg-white px-0\">\n                {\n                  (user) ? <Chat activeUser={user} /> : null\n                }\n              </section>\n            </div>\n          </div>\n        </main>\n      </Layout>\n    );\n  }\n}\n\nexport default () => (<IndexPage/>);\n\n\n// WEBPACK FOOTER //\n// pages/index.js","module.exports = require(\"axios\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"axios\"\n// module id = axios\n// module chunks = 3","module.exports = require(\"next/head\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"next/head\"\n// module id = next/head\n// module chunks = 3","module.exports = require(\"pusher-js\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"pusher-js\"\n// module id = pusher-js\n// module chunks = 3","module.exports = require(\"react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react\"\n// module id = react\n// module chunks = 3"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnEA;AACA;AACA;AACA;AAEA;AACA;AAKA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAMA;AACA;AAEA;AACA;AACA;;;;;;;;;;;;;;;;;;;;AACA;AAAA;AAAA;;;;;AAEA;AACA;AAAA;AAAA;AACA;;;;;AAmCA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AADA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AACA;AAAA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;;;;;;AAlFA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;;;AAEA;AACA;AACA;;;AAEA;AACA;AACA;;;AAqDA;AAAA;AACA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAAA;AAAA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAJA;AAAA;AAAA;AAAA;AAAA;AAQA;;;;AAjHA;AACA;AAmHA;;;;;;;;;;;ACrJA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AAFA;AAKA;AACA;AACA;AACA;AAHA;AAMA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AACA;AACA;;;;;;;;;;;;;AC7BA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAKA;AACA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpBA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;AACA;AAAA;AAAA;;;;;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;;;;;;AAEA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;AAWA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAWA;AADA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;;;;AA9DA;AACA;AAgEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;ACrEA;;;;;;;ACAA;;;;;;;ACAA;;;;;;;ACAA;;;;A","sourceRoot":""}